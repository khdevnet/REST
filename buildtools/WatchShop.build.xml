<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003"
         ToolsVersion="4.5"
         DefaultTargets="Compile">
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == ''">Debug</Configuration>
    <DeployEnvironment Condition=" '$(DeployEnvironment)' == ''">dev</DeployEnvironment>
  </PropertyGroup>
  <ItemGroup>
    <BuildArtifacts Include=".\..\buildartifacts\"/>
    <SolutionFile Include=".\..\watchshop.sln"/>
	<RoslynFiles Include=".\roslyn\*" />
	<WebProjectRoslynOutputDir Include=".\..\buildartifacts\_PublishedWebsites\WatchShop.Api\bin\roslyn\"/>
  </ItemGroup>
  <Target Name="Clean">
    <RemoveDir Directories="@(BuildArtifacts)"/>
  </Target>
  <Target Name="Init" DependsOnTargets="Clean">
    <MakeDir Directories="@(BuildArtifacts)"/>
  </Target>
  <Target Name="InstallPackages">
   <Exec Command=".nuget\NuGet.exe restore %(SolutionFile.FullPath)"/>
  </Target>
  <Target Name="CopyRoslynFiles" AfterTargets="Compile">
    <MakeDir Directories="@(WebProjectRoslynOutputDir)" />
     <Copy SourceFiles="@(RoslynFiles)" DestinationFolder="@(WebProjectRoslynOutputDir)"/>
  </Target>
  <Target Name="Compile" DependsOnTargets="Init;InstallPackages">
    <MSBuild Projects="@(SolutionFile)" Targets="Rebuild" Properties="OutDir=%(BuildArtifacts.FullPath);VisualStudioVersion=14.0;Configuration=$(Configuration)" />
  </Target>
</Project>